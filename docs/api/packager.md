パッケージ管理ツール
==

# Summary
- npmやcomposerのような、パッケージ管理ツールのようなツール。
- myntpageフレームワークで、横展開できるように設計する。
- 

# 各種バッチ処理
- Front-package
  - 半手動管理ツール
  - 管理サーバー -> フロントサーバー
  - プログラムソースコードなど、実行環境をrsyncで自動配置する
  - フロントのデプロイは、全てこのツールを使って行う。
  - 各種モジュール

- Front-data
  - 定時バッチ : 1h
  - フロントサーバーのログデータ -> adminサーバーへ移動
  - 定時バッチで、ログ収集を行う処理
  - data/mynt_api/log フォルダをリネームして、管理サーバーへ取り込むまでの処理
  - リネーム後、圧縮 -> rsync（自動削除）
  - Frontサーバーは複数設置できることを前提にする。

- Daly-analytics
  - adminサーバーにて、前日までのログデータをlog->analyticsに集計処理する。
  - 集計後のlogデータを日別にarchiveフォルダに格納する。
  - 1:00より処理開始、修理時間が3時間を超えたら、処理サーバーを分散する予定

- archive管理
  - admin/archive -> backupサーバーへ移動

- Linux-systemログの収集処理
  - /var/log/**
  - ログローテートでアーカイブされたデータのみを、一括して、バックアップサーバーに移動させる。
  - フロントサーバーのデータ圧迫を避けるため。

- サーバー間モジュール管理
  - モジュールバージョン管理
  - ログデータなどの存在、容量、などの一元管理

- nginxのsslファイル自動更新
  - ドメイン毎の最新pemなどを所定の位置へコピーして自動更新

# 機能
- フォルダ、ファイル、データのコピー
  - 完全上書き
  - 元データは消されない
- ファイル、アップデート
  - 更新されている場合に、上書き
  - 元データは消されない
- 移動
  - 元データは消される。
- push , pull
  - 親から見て、データを送信するか、受信するか
- チェック
  - 更新日の確認
  - データ容量の比較確認
  - 


# program-name
- パッケージ管理ツール
  - package.php
  - admin -> 別フォルダに環境構築をしてgit管理、 -> リポジトリに送信
  - admin -> frontに向けてpush設置（front側でpullする。）
  - 

- バッチ処理 api/mynt_api/batch/*.phpにて実行
  - log2analytics : 日別集計処理バッチ処理
    - $ php api.php module=mynt_api mode=log2json today=false

  - log2admin : 時間バッチ処理
    - 

# Composition : 構成
- 親サーバー（parent) と　子サーバー(children)の関係性にて処理を実行
  - この時、子同士の連携は、必要なし

- 親サーバーに全ての情報を保持する。

- 構成サンプル
  - 親サーバー
    - 子 : api-1サーバー1
    - 子 : api-1サーバー2
    - 子 : api-2サーバー1
    - 子 : api-2サーバー2
    - 子 : 集計サーバー1
    - 子 : 集計サーバー2
    - 子 : 集計サーバー3

- 子サーバーは、カテゴリ（グループ）を設けることができて、それ毎にまとめて処理を実行できる。



# Request
- 親サーバーを複数もたせる場合の対応について




